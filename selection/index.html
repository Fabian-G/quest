
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../score/">
      
      
        <link rel="next" href="../styling/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Selecting Tasks - Quest</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#selecting-tasks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Quest" class="md-header__button md-logo" aria-label="Quest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Selecting Tasks
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Quest" class="md-nav__button md-logo" aria-label="Quest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Quest
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../editing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Editing tasks
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Note Taking
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../recurrence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recurrence
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quest Score
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Selecting Tasks
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Selecting Tasks
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#range-query" class="md-nav__link">
    <span class="md-ellipsis">
      Range Query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#string-search" class="md-nav__link">
    <span class="md-ellipsis">
      String search
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quest-query-language-qql" class="md-nav__link">
    <span class="md-ellipsis">
      Quest Query Language (QQL)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quest Query Language (QQL)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syntax-and-semantics" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax and Semantics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Syntax and Semantics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syntactic-sugar" class="md-nav__link">
    <span class="md-ellipsis">
      Syntactic Sugar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    <span class="md-ellipsis">
      Constants
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#durations" class="md-nav__link">
    <span class="md-ellipsis">
      Durations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Durations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-and-command" class="md-nav__link">
    <span class="md-ellipsis">
      Shell and Command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macros" class="md-nav__link">
    <span class="md-ellipsis">
      Macros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-word-on-performance" class="md-nav__link">
    <span class="md-ellipsis">
      A Word on Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../styling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Styling
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tag-expansions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tag Expansions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time Tracking
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Views
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#range-query" class="md-nav__link">
    <span class="md-ellipsis">
      Range Query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#string-search" class="md-nav__link">
    <span class="md-ellipsis">
      String search
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quest-query-language-qql" class="md-nav__link">
    <span class="md-ellipsis">
      Quest Query Language (QQL)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quest Query Language (QQL)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syntax-and-semantics" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax and Semantics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Syntax and Semantics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syntactic-sugar" class="md-nav__link">
    <span class="md-ellipsis">
      Syntactic Sugar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    <span class="md-ellipsis">
      Constants
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#durations" class="md-nav__link">
    <span class="md-ellipsis">
      Durations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Durations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-and-command" class="md-nav__link">
    <span class="md-ellipsis">
      Shell and Command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macros" class="md-nav__link">
    <span class="md-ellipsis">
      Macros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-word-on-performance" class="md-nav__link">
    <span class="md-ellipsis">
      A Word on Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="selecting-tasks">Selecting Tasks</h1>
<p>When selecting tasks you can decide between 3 options: Range Query, String Search or Quest Query Language (QQL).
QQL can do everything the other two can do (and more), but might be slightly less convenient.
You can specify which type of query your are using on the command line with the <code>-q</code>, <code>-r</code> and <code>-w</code> options. 
If you don't and simply pass your query as an argument, quest will try to guess what type of query you are using.
"Guessing" means in this case that it tries to parse it as a QQL query, if that fails it tries to parse it as a range query and if that fails it finally treats it like a string search.
While this is convenient most of the time, this can behave unexpectedly if you are intending to write a QQL query, but have a syntax error, which is then silently ignored. 
In that case you should be explicit about the query type and use <code>-q</code>.</p>
<h2 id="range-query">Range Query</h2>
<p>You can select items by their line number using simple range expressions like:</p>
<ul>
<li><code>1,2,3</code>: selects tasks 1, 2 and 3</li>
<li><code>1-3</code>: Also selects tasks 1, 2 and 3</li>
<li><code>1,3-</code>: Selects tasks 1 and all tasks after and including task 3</li>
</ul>
<h2 id="string-search">String search</h2>
<p>The string search (usually <code>-w</code> flag in the CLI) will do a simple case-insensitive substring search in the task description.</p>
<h2 id="quest-query-language-qql">Quest Query Language (QQL)</h2>
<p>Quest comes with a powerful query language, which is based on first-order logic (FOL). 
If you are already familiar with FOL you should be able to get started in no time.
If not, there may be a learning curve if you want to write more advanced queries, but the basics should be pretty straightforward.</p>
<p>A basic QQL query will look like this:
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>!done(it) &amp;&amp; priority(it) &gt;= prioC &amp;&amp; substring(description(it), &quot;foo&quot;)
</span></code></pre></div>
Quest will run your query against each item in the list and checks if it matches. 
The query will receive the current item through the <code>it</code> variable.
Therefore the above query matches all items that are not done, have a priority higher or equal to (C) and contain the word "foo" in the description.</p>
<h3 id="syntax-and-semantics">Syntax and Semantics</h3>
<p>The syntax will not be explained in great detail here, because it is basically what you would expect from any programming language.</p>
<p>A primary expression can either be a function call of the form <code>function(args)</code> (see <a href="#functions">Available Function</a>), 
an integer value, a boolean value (<code>true</code> or <code>false</code>), a string literal (with double-quotes <code>"hello world"</code>), a duration literal (see <a href="#durations">Durations</a>) or a constant (see <a href="#constants">Constant</a>).</p>
<p>There are the following boolean operators: <code>!</code> (not), <code>&amp;&amp;</code> (and), <code>||</code> (or), <code>-&gt;</code> (implication, "if a then b" and equivalent to "!a || b"). 
You can always use parentheses, but if you don't, the order they are listed here is the order of precedence.</p>
<p>Example:
<div class="language-java highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">true</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="kc">false</span><span class="w"> </span><span class="c1">// equivalent to (true -&gt; (false || (true &amp;&amp; (!false))))</span>
</span></code></pre></div></p>
<p>To compare values you can use the usual <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, <code>&gt;=</code> and <code>&gt;</code> operators. 
You can compare dates, integers, strings, durations, boolean values and tasks, but the last two can only be compared with <code>==</code>.
If you want to check for inequality you can use <code>!(a == b)</code>.</p>
<p>Example:
<div class="language-java highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">ymd</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">ymd</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="w"> </span><span class="c1">// evaluates to true</span>
</span></code></pre></div></p>
<p>QQL also supports the numeric operators <code>+</code> and <code>-</code>. 
Obviously this works on the int type (<code>5+5==10</code> evaluates to true), but you can also use this for dates and durations (<code>ymd(2022,2,2)+5d==ymd(2022,2,7)</code>).</p>
<p>Finally you can use the quantifiers <code>exists</code> and <code>forall</code> over any collection.
The basic syntax is: <code>quantifier x in collection: expression</code>. Where <em>quantifier</em> is either exists or forall, x is an arbitrary variable name and collection is any collection.
<code>exists x in collection: expression</code> will evaluate to true if there is at least one item in the collection so that the expression evaluates to true (with the variable <code>x</code> set to that particular item).
Similarly <code>forall x in collection: expression</code> evaluates to true if <code>expression</code> is true for all items in the collection.
There are multiple ways to obtain a collection to quantify over:</p>
<ol>
<li>Use the <code>items</code> constant, which contains all items in your list: <code>forall item in items: done(item)</code> (evaluates to true if all items in the list are done)</li>
<li>Use <code>projects</code> or <code>contexts</code> function: <code>exists proj in projects(it): proj == "+foo"</code> (evaluates to true if <code>it</code> is in the project "+foo")</li>
<li>Use <code>list</code> to transform any string (for example from a tag) to a list: <code>exists num in list(tag(it, "favorite-numbers")): num == "2"</code> (matches for example <code>favorite-numbers:1,2,3</code>)</li>
</ol>
<p>A common pattern is to make a statement about all items that fulfil a certain precondition. This is where the implication operator comes in handy. 
For example if we wanted to check if <code>it</code> is the last not done item in a group of items we could write: <code>!done(it) &amp;&amp; forall other in items: tag(it, "group") == tag(other, "group") &amp;&amp; !(it == other) -&gt; done(other)</code> "match it if: it is not done and all other items that have the same group-tag as it are done".</p>
<h4 id="syntactic-sugar">Syntactic Sugar</h4>
<p>Function calls come with two rules that make the average usage of QQL a little more convenient:</p>
<ol>
<li>If a function call requires an item as an argument and it is omitted, it will simply be replaced by <em>it</em>. For example writing <code>done()</code> is the same as <code>done(it)</code></li>
<li>If the argument list is empty, the parentheses can be omitted: <code>done()</code> is the same as writing <code>done</code></li>
</ol>
<p>For example: <code>!done &amp;&amp; priority &gt;= prioC</code> matches all tasks that are not done and have a priority of at least (C).</p>
<p>Another extension to the syntax is that you can check if <em>it</em> is in a specific (sub) project by using the project matcher syntax: <code>+foo</code>.
The same is possible for contexts with <code>@foo</code>.</p>
<p>Example: <code>@foo &amp;&amp; +bar</code> matches all items that are in a (sub) context of foo (e.g. @foo, @foo.bar, ...) and in a (sub) project of bar.</p>
<p>Note that the project matcher syntax introduces a slight ambiguity between the numeric operation <code>+</code> and the project matching.
To make sure that a <code>+</code> is interpreted as the numeric operation make sure to put a space behind it (e.g. <code>5+ aNumber</code>).</p>
<h4 id="constants">Constants</h4>
<p>The following constants are available:</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>it</td>
<td>The task item that the query is currently evaluated against</td>
</tr>
<tr>
<td>items</td>
<td>The list of all task items</td>
</tr>
<tr>
<td>maxInt</td>
<td>The maximum integer value</td>
</tr>
<tr>
<td>minInt</td>
<td>The minimum integer value</td>
</tr>
<tr>
<td>today</td>
<td>todays date</td>
</tr>
<tr>
<td>maxDate</td>
<td>The maximum date value</td>
</tr>
<tr>
<td>minDate</td>
<td>The minimum date value</td>
</tr>
<tr>
<td>prio*</td>
<td>The priority *. Where * is a letter between A and Z.</td>
</tr>
<tr>
<td>prioNone</td>
<td>The priority that signals the absence of a priority</td>
</tr>
</tbody>
</table>
<h3 id="durations">Durations</h3>
<p>A duration literal follows the syntax <code>span unit</code>, where <em>span</em> is a (possibly negative) integer value and unit one of:</p>
<ul>
<li>days (or d) </li>
<li>weeks (or w)</li>
<li>months (or m)</li>
<li>years (or y)</li>
</ul>
<p>Examples: <code>+5y</code>, <code>-5days</code>, ...</p>
<h4 id="functions">Functions</h4>
<p>A short explanation of the notation: If in the following table the function definition says for example <code>func(a: int, b: date = minDate): bool</code>, 
this means that the function with the name <code>func</code> takes two arguments. The first one must be of type <code>int</code> and the second of type <code>date</code>.
The second argument is optional and can be omitted. If it is omitted it will be set to <code>minDate</code>. The return type of the function is <code>bool</code>.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>line(i: item): int</td>
<td>The line number of i</td>
</tr>
<tr>
<td>done(i: item): bool</td>
<td>Whether or not i is already completed</td>
</tr>
<tr>
<td>description(i: item): string</td>
<td>The description of i (including all tags, projects and contexts)</td>
</tr>
<tr>
<td>creation(i: item, default: date = minDate): date</td>
<td>The creation date of i if it is set or default otherwise</td>
</tr>
<tr>
<td>completion(i: item, default: date = maxDate): date</td>
<td>The completion date of i if set or default otherwise</td>
</tr>
<tr>
<td>projects(i: item): []string</td>
<td>The projects that are present in the description of i in a list. The elements of the list do contain the leading + symbol</td>
</tr>
<tr>
<td>contexts(i: item): []string</td>
<td>The contexts that are present in the description of i in a list. The elements of the list do contain the leading @ symbol</td>
</tr>
<tr>
<td>priority(i: item): priority</td>
<td>The priority of i. If no priority is set on i <code>prioNone</code> is returned</td>
</tr>
<tr>
<td>dotPrefix(s: string, prefix: string): bool</td>
<td>Checks if <em>s</em> starts with all the dot delimited segments of <em>prefix</em>. This is useful if you want to use sub projects or contexts. Examples: <code>dotPrefix("+foo.bar.baz", "+foo.bar") == true</code>, <code>dotPrefix("+foo.bar.baz", "+foo.b") == false</code></td>
</tr>
<tr>
<td>substring(s: string, sub: string): bool</td>
<td>Tests if <em>s</em> contains substring <em>sub</em></td>
</tr>
<tr>
<td>ymd(year: int, month: int, day: int): date</td>
<td>Constructs a date from the provided year, month and day</td>
</tr>
<tr>
<td>date(yyyymmdd: string, default: date = minDate): date</td>
<td>Parses the given argument into a date (format YYYY-MM-dd). If the format does not match the default is returned</td>
</tr>
<tr>
<td>tag(i: item, key: string, default: string = ""): string</td>
<td>Returns the value of the first occurrence of the tag with key <em>key</em>. If <em>key</em> is not set <em>default</em> is returned</td>
</tr>
<tr>
<td>list(l: string): []string</td>
<td>Splits the value l at ",". For example <code>list("1,2,3")</code> becomes the list with the elements 1,2 and 3.</td>
</tr>
<tr>
<td>int(num: string, default: int = 0): int</td>
<td>Parses <em>num</em> as an integer. If <em>num</em> is not a valid integer <em>default</em> is returned</td>
</tr>
<tr>
<td>shell(i: item, cmd: string): string</td>
<td>Runs <em>cmd</em> using bash. See (<a href="#shell-and-command">shell and command</a>)</td>
</tr>
<tr>
<td>command(i: item, cmd: string): string</td>
<td>Same as shell, but runs the cmd directly without bash</td>
</tr>
</tbody>
</table>
<h5 id="shell-and-command">Shell and Command</h5>
<p>If you want to write really exotic queries you can resort to shell and command, but be aware that using these functions comes with a high performance penalty.
The way this works is that the command will receive a json representation of the specified task (like the one you get with <code>--json</code>) on stdin.
Whatever is output on stdout will then be space trimmed and returned.</p>
<p>Example (Match all tasks that were created during full moon):
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>int(shell(&quot;jq -r .creation\ \|\ sub\(\&quot;-\&quot;\;\&quot;\&quot;\;\&quot;g\&quot;\)+\&quot;00\&quot; | xargs pom | sed s/\[^0-9\]//g&quot;), 0) &gt;= 94
</span></code></pre></div></p>
<p>As you can see in the above example, properly escaping the string is not fun. Therefore I would recommend to always put the command in a separate file and 
then use the <code>command</code> function instead.</p>
<h3 id="macros">Macros</h3>
<p>Macros are a way to give a name to parts of your query so that your queries can be reused and look cleaner.
A simple macro definition in your <code>config.toml</code> might look like this:</p>
<div class="language-toml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Use &quot;after&quot; and &quot;id&quot; tags to express dependencies between tasks</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">[[macro]]</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;blocked&quot;</span><span class="w"> </span><span class="c1"># How you would like to call your macro</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;item&quot;</span><span class="p">]</span><span class="w">  </span><span class="c1"># The types of arguments that the macro expects. The parameters will be available as arg0, arg1, ...</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bool&quot;</span><span class="w">  </span><span class="c1"># The return type of this macro</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;!(tag(arg0, &quot;after&quot;, &quot;&quot;) == &quot;&quot;) &amp;&amp; (exists pre in items: tag(pre, &quot;id&quot;, &quot;&quot;) == tag(arg0, &quot;after&quot;) &amp;&amp; !done(pre))&#39;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">inject-it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c1"># Whether or not a missing item parameter should default to &quot;it&quot;. Because this is true we can just write &quot;blocked&quot; instead of &quot;blocked(it)&quot;</span>
</span></code></pre></div>
<p>Note that if you reference other macros from within your macro definition, the other macros must appear before this definition in your config file.</p>
<p>With this definition in place you can then write queries like: <code>!done &amp;&amp; !blocked</code> to find not completed tasks that are not blocked.</p>
<h3 id="a-word-on-performance">A Word on Performance</h3>
<p>Since QQL is effectively a (brute-force) model checker for first-order logic (which is a PSPACE-Complete problem) the performance 
of running your query may theoretically be extremely bad. 
But unless you are dealing with a massive todo file or nest your quantifiers miles deep you will probably be fine. 
If for whatever reason you are facing performance issues anyway here are a few things you can do:</p>
<ol>
<li>Use <code>quest archive</code>. This will move your completed tasks to a separate file and will therefore reduce the number of tasks that need to be checked against your query.</li>
<li>Make use of <strong>short-circuiting</strong> by moving the expensive operations (e.g. quantification over large collections) to the end of your query. For example <code>!done(it) &amp;&amp; expensiveMacro(it)</code> could be significantly faster than <code>expensiveMacro(it) &amp;&amp; !done(it)</code>, because in the former case <code>expensiveMacro(it)</code> will only be checked on tasks that are not done.</li>
<li>Do not use <code>shell</code> or <code>command</code> functions if at all possible. These operations are not only asymptotically slow, but are actually slow in practice. So if you can, avoid using them. Otherwise refer to point 2.</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>